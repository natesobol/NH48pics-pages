<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NH48 CTA</title>
<style>
/* global theme variables */
/* CTA grid: use full width with symmetric padding equal to the gap */
.nh-cta-grid {
  /* theme colours */
  --bg:#0b1220;
  --border:#22314a;
  --text:#e6edf3;
  --green:#22c55e;
  --btn-text:#0a0a0a;
  font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;
  display:grid;
  gap:24px;
  width:100%;
  margin:0 auto;
  padding:0 24px; /* left/right padding equals gap */
  box-sizing:border-box;
}
/* two column layout on medium+ screens */
@media (min-width:820px) {
  .nh-cta-grid { grid-template-columns:1fr 1fr; }
}

/* -------------------- search card -------------------- */
.nh-search-card {
  grid-column:1 / -1;
  background:var(--bg);
  border:1px solid var(--border);
  border-radius:16px;
  padding:16px 20px;
  display:flex;
  align-items:center;
  gap:12px;
  box-shadow:0 2px 6px rgba(0,0,0,.3);
}
/* search field styling */
.nh-search-input {
  flex:1;
  padding:12px 16px;
  border-radius:999px;
  border:1px solid var(--border);
  background:var(--bg);
  color:var(--text);
  font-size:16px;
}
.nh-search-input::placeholder {
  color:#6b7280;
}
/* Search wrapper holds the preview image and input; suggestions appear absolutely beneath */
.nh-search-wrapper {
  position: relative;
  display: flex;
  align-items: center;
  flex: 1;
}
/* Preview image next to search field */
.nh-search-logo {
  width: 42px;
  height: 42px;
  border-radius: 10px;
  object-fit: cover;
  flex-shrink: 0;
  margin-right: 8px;
  border: 2px solid #ffffff;
  box-shadow: 0 0 6px rgba(0,0,0,.35);
}
/* Custom suggestions container */
.nh-suggestions {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 10px;
  z-index: 999;
  margin-top: 4px;
  display: none;
  max-height: 200px;
  overflow-y: auto;
}
/* Individual suggestion row */
.nh-suggestion {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  color: var(--text);
  cursor: pointer;
  border-bottom: 1px dotted var(--border);
}
.nh-suggestion:last-child {
  border-bottom: none;
}
.nh-suggestion:hover {
  background: var(--border);
}
.nh-suggestion img {
  width: 32px;
  height: 32px;
  border-radius: 8px;
  object-fit: cover;
  border: 1px solid #ffffff;
  flex-shrink: 0;
}
.nh-suggestion span {
  flex: 1;
}

/* -------------------- card styles -------------------- */
.nh-card {
  background:var(--bg);
  border:1px solid var(--border);
  border-radius:16px;
  color:var(--text);
  box-shadow:0 2px 6px rgba(0,0,0,.3);
}
.nh-card-body{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:18px;
  padding:18px 20px;
  min-height:110px;
}
.nh-left{
  display:flex;
  align-items:center;
  gap:14px;
  flex:1;
  min-width:0;
}
.nh-right{
  display:flex;
  align-items:center;
}
.nh-card-text{
  margin:0;
  font-size:16px;
  line-height:1.5;
  color:var(--text);
}
.nh-card-text strong{
  color:#fff;
}
.nh-card-copy{
  display:flex;
  flex-direction:column;
  justify-content:center;
}
.nh-btn{
  display:inline-block;
  padding:10px 18px;
  border-radius:999px;
  font-weight:700;
  text-decoration:none;
  white-space:nowrap;
  transition:all .15s ease;
  outline-offset:3px;
  font-size:15px;
}
.nh-btn:focus-visible{
  box-shadow:0 0 0 3px rgba(255,255,255,.18);
}
.nh-btn-green{
  background:var(--green);
  color:var(--btn-text);
  border:1px solid transparent;
}
.nh-btn-green:hover{
  transform:translateY(-1px);
  box-shadow:0 2px 8px rgba(34,197,94,.25);
}
.nh-btn-right{
  margin-left:auto;
}
/* Instagram specifics */
.nh-ig{
  gap:16px;
}
.nh-ig-logo{
  width:42px;
  height:42px;
  object-fit:cover;
  border-radius:10px;
  flex-shrink:0;
  border:2px solid #ffffff;
  box-shadow:0 0 6px rgba(0,0,0,.35);
}
/* Peakbagger panel logo (same style as Instagram profile image) */
.nh-peak-logo {
  width:42px;
  height:42px;
  object-fit:cover;
  border-radius:10px;
  flex-shrink:0;
  border:2px solid #ffffff;
  box-shadow:0 0 6px rgba(0,0,0,.35);
}

/* ensure the Howker Ridge navigation card spans both columns on larger screens */
.hrt-nav-card {
  grid-column:1 / -1;
}

/* -------------------- HRT card specific styles -------------------- */
/* ensure the Howker Ridge card uses a vertical layout and expands as needed */
.hrt-card {
  display:flex;
  flex-direction:column;
  align-items:stretch;
  justify-content:flex-start;
  gap:14px;
  padding:18px 20px;
  min-height:auto;
}
/* heading within the HRT card */
.hrt-heading {
  font-weight:700;
  font-size:18px;
  margin:0;
  text-align:center;
}

/* Centered layout for secondary CTA cards (Peakbagger and Instagram) */
.cta-card {
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  text-align:center;
  gap:14px;
  padding:18px 20px;
  min-height:110px;
}

/* ensure text inside CTA cards is centered */
.cta-card p {
  text-align:center;
}

/* -------------------- HRT navigation card -------------------- */
/* The fourth card contains multiple links to HRT projects.
   It adopts the same colour scheme and rounded corners as other CTA cards. */
.hrt-nav {
  /* navigation bar for Howker Ridge projects: horizontal by default */
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  align-items:center;
  gap:12px;
  margin-top:6px;
}
.hrt-nav a {
  /* project links: auto width with minimal padding */
  display:inline-flex;
  align-items:center;
  justify-content:center;
  /* slightly tighter padding so buttons fit on narrow screens */
  padding:0.4rem 0.9rem;
  background-color:var(--green);
  color:var(--btn-text);
  border:1px solid var(--border);
  border-radius:9999px;
  text-decoration:none;
  font-weight:700;
  font-size:15px;
  line-height:1.2;
  white-space:nowrap;
  box-shadow:0 2px 4px rgba(0,0,0,0.25);
  transition:background-color .3s ease, box-shadow .3s ease, transform .15s ease;
}
.hrt-nav a:hover {
  background-color: #1fa250;
  transform: translateY(-2px);
  box-shadow:0 0 10px rgba(255,255,255,0.35);
}
/* responsive behaviour for HRT nav: stack items on very narrow screens */
@media (max-width:500px) {
  /* Stack the project links vertically and center them */
  .hrt-nav {
    flex-direction:column;
    align-items:center;
  }
  .hrt-nav a {
    /* Allow the buttons to size themselves based on content */
    width:auto;
    max-width:none;
    font-size:13px;
    padding:0.5rem 0.8rem;
  }
}

/* -------------------- responsive adjustments -------------------- */
/* Mobile adjustments: tighter spacing and smaller elements so more fits above the fold */
@media (max-width:700px){
  .nh-cta-grid{
    gap:14px;
    padding:0 14px;
  }
  /* search card: slightly smaller gap and padding */
  .nh-search-card{
    padding:12px 14px;
    gap:10px;
  }
  /* use smaller logos on mobile for other cards */
  .nh-card-body{
    flex-direction:column;
    text-align:center;
    padding:12px 14px;
    min-height:auto;
    gap:10px;
  }
  .nh-left{ justify-content:center; }
  .nh-btn-right{ margin-left:0; }
  .nh-card-text{
    font-size:14px;
    line-height:1.4;
  }
  .nh-btn{
    padding:8px 14px;
    font-size:14px;
  }
  .nh-peak-logo,
  .nh-ig-logo{
    width:34px;
    height:34px;
  }
  /* ensure the search logo stays small on mobile */
  .nh-search-logo{
    width:42px;
    height:42px;
  }
  .nh-search-input{
    padding:12px 16px;
    font-size:16px;
  }
  /* stack Howker project links on mobile */
  .hrt-nav {
    /* stack links vertically on narrow screens */
    flex-direction:column;
    align-items:center;
  }
  .hrt-nav a {
    /* auto width to fit content instead of 100% */
    width:auto;
    font-size:14px;
    /* match tighter padding to keep buttons compact */
    padding:0.4rem 0.9rem;
    margin:0;
  }
}
/* Desktop enhancements: make search bar and logo more prominent */
@media (min-width:700px){
  .nh-search-card{
    padding:20px 26px;
    gap:16px;
  }
  .nh-search-logo{
    width:56px;
    height:56px;
  }
  .nh-search-input{
    padding:14px 18px;
    font-size:18px;
  }
  #nh-search-btn.nh-btn{
    padding:12px 20px;
    font-size:16px;
  }
}
</style>
</head>
<body>
<div class="nh-cta-grid">
  <!-- Search Card -->
  <div class="nh-search-card">
    <!-- Search wrapper contains preview image, input and suggestions -->
    <div class="nh-search-wrapper">
      <!-- Preview image updates to selected peak's primary photo -->
      <!-- Use NH48 API logo as the default preview icon -->
      <img id="nh-search-preview" class="nh-search-logo" src="nh48API_logo.png" alt="NH48 API logo" />
      <input id="nh-search" class="nh-search-input" type="search" placeholder="Search NH48 peaks for a view of the summit, trail information, and more..." autocomplete="off">
      <!-- Custom suggestions list (hidden by default) -->
      <div id="nh-suggestions" class="nh-suggestions"></div>
    </div>
    <!-- Go button remains separate for accessibility -->
    <button id="nh-search-btn" class="nh-btn nh-btn-green">Go</button>
  </div>

  <!-- Howker Ridge Projects navigation card (moved under the search bar) -->
  <div class="nh-card hrt-nav-card">
    <div class="nh-card-body hrt-card">
      <p class="nh-card-text hrt-heading">Explore Howker Ridge Projects</p>
      <nav class="hrt-nav">
        <a href="https://www.nh48pics.com/hrt-plant-catalog" target="_blank" rel="noopener">Plant Catalog</a>
        <a href="https://www.nh48pics.com/hrt-trail-map" target="_blank" rel="noopener">Trail Map</a>
        <a href="https://www.nh48pics.com/hrt-info" target="_blank" rel="noopener">Trail Info</a>
        <a href="https://www.nh48pics.com/howker-data" target="_blank" rel="noopener">Trail Conditions</a>
      </nav>
    </div>
  </div>

  <!-- Peakbagger CTA -->
  <div class="nh-card">
    <div class="cta-card">
      <img class="nh-peak-logo" src="https://static.wixstatic.com/media/66b1b2_c577d5f395d84e10b6e2c54a428c51a0~mv2.png" alt="Peakbagger logo" />
      <p class="nh-card-text" style="max-width:100%">
        Track, save &amp; export your hiking lists privately and for free with
        <strong>Peakbagger’s Journal Web App</strong>.
      </p>
      <a href="https://www.nh48pics.com/peakbagger"
         class="nh-btn nh-btn-green"
         target="_top"
         aria-label="Open Peakbagger’s Journal Web App">
        Open the app →
      </a>
    </div>
  </div>

  <!-- Instagram CTA -->
  <div class="nh-card">
    <div class="cta-card">
      <img class="nh-ig-logo"
           src="https://static.wixstatic.com/media/66b1b2_ae7d4a9a1f6a410299a45f7cf4748203~mv2.jpg"
           alt="Instagram profile logo" />
      <p class="nh-card-text">
        See my latest White Mountains photos
        <strong>@nate_dumps_pics</strong>.
      </p>
      <a href="https://instagram.com/nate_dumps_pics"
         class="nh-btn nh-btn-green"
         target="_top"
         aria-label="View photos on Instagram">
        View Photos
      </a>
    </div>
  </div>


</div>

<script type="module">
const NH48_API_URL = "https://rawcdn.githack.com/natesobol/nh48-api/main/data/nh48.json";
const nhSearch = document.getElementById("nh-search");
const nhSearchBtn = document.getElementById("nh-search-btn");
const nhSuggestions = document.getElementById("nh-suggestions");
const nhPreview = document.getElementById("nh-search-preview");
let nhData = null;

// Load the NH48 dataset once and cache it. Each entry includes the first photo for thumbnail.
async function loadNh48() {
  if (nhData) return;
  try {
    const resp = await fetch(NH48_API_URL);
    if (!resp.ok) return;
    nhData = await resp.json();
  } catch (e) {
    console.error(e);
  }
}

function slugify(name) {
  return (name || "").toLowerCase().replace(/[^a-z0-9]+/g, "-").replace(/^-+|-+$/g, "");
}

function goToPeak() {
  const name = nhSearch.value.trim();
  if (!name) return;
  const slug = slugify(name);
  // Navigate to the NH48 API peak detail page
  window.open(`https://natesobol.github.io/nh48-api/nh48_peak.html?slug=${slug}`, "_top");
}

// Render suggestion list based on current query
function renderSuggestions(list) {
  // Clear previous suggestions
  nhSuggestions.innerHTML = "";
  if (!list || list.length === 0) {
    nhSuggestions.style.display = "none";
    return;
  }
  list.forEach((item) => {
    const div = document.createElement("div");
    div.className = "nh-suggestion";
    // Thumbnail
    const img = document.createElement("img");
    img.src = item.thumb || item.url || "";
    img.alt = item.name;
    div.appendChild(img);
    // Name
    const span = document.createElement("span");
    span.textContent = item.name;
    div.appendChild(span);
    // Click handler: fill input, update preview, navigate
    div.addEventListener("click", () => {
      nhSearch.value = item.name;
      // update preview image
      if (item.url) nhPreview.src = item.url;
      nhSuggestions.style.display = "none";
      goToPeak();
    });
    nhSuggestions.appendChild(div);
  });
  nhSuggestions.style.display = "block";
}

// Search dataset for matches and build suggestions
function updateSuggestions() {
  const q = nhSearch.value.trim().toLowerCase();
  if (!q) {
    nhSuggestions.style.display = "none";
    return;
  }
  // Ensure data is loaded
  if (!nhData) return;
  // Build list of matching peaks (limit 10)
  const matches = [];
  Object.entries(nhData).some(([slug, entry]) => {
    const name = entry.peakName || entry["Peak Name"] || "";
    if (!name) return false;
    if (name.toLowerCase().includes(q)) {
      const photos = entry.photos || [];
      // Use first photo for thumb and url
      const first = photos[0] || {};
      matches.push({ name, slug, url: first.url || "", thumb: first.thumb || first.url || "" });
      if (matches.length >= 10) return true;
    }
    return false;
  });
  renderSuggestions(matches);
}

// When typing, ensure data loaded and update suggestions
nhSearch.addEventListener("input", async () => {
  await loadNh48();
  updateSuggestions();
});
// Enter key triggers navigation
nhSearch.addEventListener("keydown", (e) => {
  if (e.key === "Enter") {
    e.preventDefault();
    nhSuggestions.style.display = "none";
    goToPeak();
  }
});
// Go button triggers navigation
nhSearchBtn.addEventListener("click", () => {
  nhSuggestions.style.display = "none";
  goToPeak();
});
</script>
</body>
</html>
